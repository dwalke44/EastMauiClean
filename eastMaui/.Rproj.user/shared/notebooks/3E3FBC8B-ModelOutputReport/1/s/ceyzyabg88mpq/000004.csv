"0","# Water in Basins"
"0","groups = watersheds"
"0","match1 = groups[ ,c(1:9)]"
"0","scenario.currentw = as.data.frame(basinWater.fun(nodes.mat, waterInput.mat))"
"0","scenario.1w = as.data.frame(basinWater.fun(nodes1.mat, waterInput.mat))"
"0","scenario.0w = as.data.frame(basinWater.fun(nodes0.mat, waterInput.mat))"
"0","# --------------------------------------------------------------------------------------------------"
"0","# append outputs"
"0","scenario.currentw = scenario.currentw[1, ]"
"0","scenario.1w = scenario.1w[1,]"
"0","scenario.0w = scenario.0w[1,]"
"0","scenario.cw = as.data.frame(t(scenario.currentw))"
"0","scenario.1tw = as.data.frame(t(scenario.1w))"
"0","scenario.0tw = as.data.frame(t(scenario.0w))"
"0","scenario.cw = tibble::rownames_to_column(scenario.cw, var = ""rowname"")"
"0","colnames(scenario.cw)[2] = ""MixedScen"""
"0","scenario.0tw = rownames_to_column(scenario.0tw)"
"0","scenario.1tw = rownames_to_column(scenario.1tw, var = ""rowname"")"
"0","colnames(scenario.1tw) = c(""rowname"", ""All_1"")"
"0","colnames(scenario.0tw) = c(""rowname"",""All_0"")"
"0","scenario.testw = merge(scenario.cw, scenario.0tw, by = ""rowname"" ) %>%"
"0","  left_join(scenario.1tw) %>%"
"0","  separate(rowname, into = c(""E"", ""Wshed""), sep = ""^([E])"")"
"2","Joining, by = ""rowname""
"
"0","# match basinID to watershed"
"0","colnames(scenario.testw)[1] = 'Wshed'"
"0","colnames(scenario.testw)[2] = ""BASINID"""
"0","colnames(scenario.testw)[3] = ""mixed"""
"0","scenario.testw$BASINID = as.numeric(scenario.testw$BASINID)"
"0","scenario.testw$Wshed = as.numeric(scenario.testw$Wshed)"
"0","wsheds = watersheds[ ,c(1,2)]"
"0","scenario.testw = left_join(scenario.testw, wsheds, by = ""BASINID"")"
"0","scenario.testw = scenario.testw[ ,-1]"
"0","scenario.testw = scenario.testw[ ,c(5,1:4)]"
"0","basins = scenario.testw[ ,c(2:5)]"
"0","datw = left_join(match1, basins, by = ""BASINID"")"
"0","datw$BFQ = watersheds$BFQ95"
"0","writexl::write_xlsx(datw, paste(path, ""/WaterInBasinsv0.6.2.xlsx"", sep = """"))"
"2","["
"2","ERROR] workbook_close(): Error creating 'C:\Users\danwa\Documents\Programming\Trutta\HSHEP\EMaui\EMpackage\eastMaui\rawData\WaterInBasinsv0.6.2.xlsx'. Error = Permission denied
"
"1","[1]"
"1"," ""C:\\Users\\danwa\\Documents\\Programming\\Trutta\\HSHEP\\EMaui\\EMpackage\\eastMaui\\rawData\\WaterInBasinsv0.6.2.xlsx"""
"1","
"
"0","datj = watersheds[ ,c(2,9:16)]"
"0","# calculate X for input to functions below"
"0","dat.sp = left_join(datw, datj, by = ""BASINID"") "
"0","dat.sp$divert.mixed = ((dat.sp$mixed-dat.sp$BFQ)/dat.sp$BFQ)*100"
"0","dat.sp$divert.0 = ((dat.sp$All_0-dat.sp$BFQ)/dat.sp$BFQ)*100"
"0","dat.sp$divert.1 = ((dat.sp$All_1-dat.sp$BFQ)/dat.sp$BFQ)*100"
"0","dat.sp$divert.mixed1 = dat.sp$mixed/dat.sp$BFQ"
"0","dat.sp$divert.01 = dat.sp$All_0/dat.sp$BFQ"
"0","dat.sp$divert.11 = dat.sp$All_1/dat.sp$BFQ"
"0","# functions to calculate effects of diverted water on habitat"
"0","other.sp = function(x){"
"0","  y = 100*(1-(0.0000681*((100-x)^2) - 0.00032*(100-x)))"
"0","  return(y)  "
"0","}"
"0","ab.hab = function(x){"
"0","  y =100*(1-(0.00004678*((100-x)^2) + 0.000313*(100-x)))"
"0","}"
"0","# calculate effected habitat for each species"
"0","dat.sp$ASeffect.mix = other.sp(dat.sp$divert.mixed)"
"0","dat.sp$ASeffect.0 = other.sp(dat.sp$divert.0)"
"0","dat.sp$ASeffect.1 = other.sp(dat.sp$divert.1)"
"0","dat.sp$ABeffect.mix = ab.hab(dat.sp$divert.mixed)"
"0","dat.sp$ABeffect.0 = ab.hab(dat.sp$divert.0)"
"0","dat.sp$ABeffect.1 = ab.hab(dat.sp$divert.1)"
